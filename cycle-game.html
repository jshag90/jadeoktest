<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ìì „ê±° ì¥ì• ë¬¼ ê²Œì„</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #87ceeb;
    font-family: Arial, sans-serif;
  }
  canvas {
    display: block;
    background: linear-gradient(to bottom, #2d3748 0%, #4a5568 100%);
    box-shadow: 0 4px 20px rgba(0,0,0,0.3); /* ê·¸ë¦¼ì ì¶”ê°€ */
    border: 2px solid #333;
  }
  .game-container {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    background: linear-gradient(45deg, #2d3748, #4a5568);
  }
</style>
</head>
<body>
<div class="game-container">
  <canvas id="gameCanvas"></canvas>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = 400;
canvas.height = 600;

let bike = { x: 180, y: 500, width: 40, height: 60 };
let obstacles = [];
let powerGels = [];
let waterBottles = [];
let particles = [];
let scorePopups = [];
let score = 0;
let gameSpeed = 2;
let keys = {};
let animationFrame = 0;
let powerBoostTime = 0;
let shieldTime = 0;

document.addEventListener('keydown', (e) => keys[e.key] = true);
document.addEventListener('keyup', (e) => keys[e.key] = false);

// íŒŒí‹°í´ íš¨ê³¼ ìƒì„±
function createParticles(x, y, count = 8) {
    for(let i = 0; i < count; i++) {
        particles.push({
            x: x,
            y: y,
            vx: (Math.random() - 0.5) * 8,
            vy: (Math.random() - 0.5) * 8,
            size: Math.random() * 6 + 2,
            color: `hsl(${Math.random() * 60 + 40}, 100%, 60%)`,
            life: 1,
            decay: Math.random() * 0.02 + 0.01
        });
    }
}

// ì ìˆ˜ íŒì—… ìƒì„±
function createScorePopup(x, y, points) {
    scorePopups.push({
        x: x,
        y: y,
        text: `+${points}`,
        life: 1,
        decay: 0.02
    });
}

// íŒŒí‹°í´ ê·¸ë¦¬ê¸° ë° ì—…ë°ì´íŠ¸
function updateAndDrawParticles() {
    particles.forEach((particle, index) => {
        // íŒŒí‹°í´ ì´ë™
        particle.x += particle.vx;
        particle.y += particle.vy;
        particle.life -= particle.decay;
        particle.size *= 0.98;
        
        // íŒŒí‹°í´ ê·¸ë¦¬ê¸°
        if(particle.life > 0) {
            ctx.save();
            ctx.globalAlpha = particle.life;
            ctx.fillStyle = particle.color;
            ctx.shadowColor = particle.color;
            ctx.shadowBlur = 10;
            ctx.beginPath();
            ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
            ctx.fill();
            ctx.restore();
        } else {
            particles.splice(index, 1);
        }
    });
}

// ì ìˆ˜ íŒì—… ê·¸ë¦¬ê¸° ë° ì—…ë°ì´íŠ¸
function updateAndDrawScorePopups() {
    scorePopups.forEach((popup, index) => {
        // íŒì—… ì´ë™
        popup.y -= 2;
        popup.life -= popup.decay;
        
        // íŒì—… ê·¸ë¦¬ê¸°
        if(popup.life > 0) {
            ctx.save();
            ctx.globalAlpha = popup.life;
            ctx.fillStyle = '#ffd93d';
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.font = 'bold 20px Arial';
            ctx.shadowColor = '#000';
            ctx.shadowBlur = 3;
            ctx.strokeText(popup.text, popup.x, popup.y);
            ctx.fillText(popup.text, popup.x, popup.y);
            ctx.restore();
        } else {
            scorePopups.splice(index, 1);
        }
    });
}

// ìì „ê±° íƒ€ëŠ” ì‚¬ëŒ ê·¸ë¦¬ê¸°
function drawBiker(x, y, width, height) {
    const centerX = x + width / 2;
    const centerY = y + height / 2;
    
    ctx.save();
    
    // íŒŒì›Œ ë¶€ìŠ¤íŠ¸ íš¨ê³¼
    if(powerBoostTime > 0) {
        ctx.shadowColor = '#ffd93d';
        ctx.shadowBlur = 15;
        ctx.filter = 'brightness(1.2)';
    }
    
    // ìì „ê±° í”„ë ˆì„
    ctx.strokeStyle = powerBoostTime > 0 ? '#ff6b6b' : '#333';
    ctx.lineWidth = 3;
    
    // ë’·ë°”í€´
    ctx.beginPath();
    ctx.arc(centerX - 12, centerY + 15, 8, 0, Math.PI * 2);
    ctx.stroke();
    
    // ì•ë°”í€´
    ctx.beginPath();
    ctx.arc(centerX + 12, centerY + 15, 8, 0, Math.PI * 2);
    ctx.stroke();
    
    // ìì „ê±° í”„ë ˆì„
    ctx.beginPath();
    ctx.moveTo(centerX - 12, centerY + 15);
    ctx.lineTo(centerX, centerY);
    ctx.lineTo(centerX + 12, centerY + 15);
    ctx.moveTo(centerX, centerY);
    ctx.lineTo(centerX, centerY - 15);
    ctx.stroke();
    
    // í•¸ë“¤ë°”
    ctx.beginPath();
    ctx.moveTo(centerX - 6, centerY - 12);
    ctx.lineTo(centerX + 6, centerY - 12);
    ctx.stroke();
    
    // ì‚¬ëŒ ë¨¸ë¦¬
    ctx.fillStyle = '#ffdbac';
    ctx.beginPath();
    ctx.arc(centerX + 2, centerY - 25, 6, 0, Math.PI * 2);
    ctx.fill();
    
    // í—¬ë©§
    ctx.fillStyle = '#ff6b6b';
    ctx.beginPath();
    ctx.arc(centerX + 2, centerY - 27, 7, Math.PI, 2 * Math.PI);
    ctx.fill();
    
    // ëª¸í†µ
    ctx.fillStyle = '#4ecdc4';
    ctx.fillRect(centerX - 3, centerY - 18, 6, 15);
    
    // íŒ” (í•¸ë“¤ë°” ì¡ëŠ” ëª¨ì–‘)
    ctx.strokeStyle = '#ffdbac';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(centerX - 3, centerY - 10);
    ctx.lineTo(centerX - 8, centerY - 12);
    ctx.moveTo(centerX + 3, centerY - 10);
    ctx.lineTo(centerX + 8, centerY - 12);
    ctx.stroke();
    
    // ë‹¤ë¦¬ (í˜ë‹¬ ë°ŸëŠ” ëª¨ì–‘)
    const pedalOffset = Math.sin(animationFrame * 0.3) * 3;
    ctx.beginPath();
    ctx.moveTo(centerX - 2, centerY - 3);
    ctx.lineTo(centerX - 8, centerY + 8 + pedalOffset);
    ctx.moveTo(centerX + 2, centerY - 3);
    ctx.lineTo(centerX + 8, centerY + 8 - pedalOffset);
    ctx.stroke();
    
    ctx.restore();
}

// ì‚¬ëŒ ì¥ì• ë¬¼ ê·¸ë¦¬ê¸°
function drawPerson(x, y, width, height) {
    const centerX = x + width / 2;
    const centerY = y + height / 2;
    
    ctx.save();
    
    // ë¨¸ë¦¬
    ctx.fillStyle = '#ffdbac';
    ctx.beginPath();
    ctx.arc(centerX, centerY - height/3, width/6, 0, Math.PI * 2);
    ctx.fill();
    
    // ëª¸í†µ
    ctx.fillStyle = '#ff9f43';
    ctx.fillRect(centerX - width/6, centerY - height/4, width/3, height/2);
    
    // íŒ”
    ctx.strokeStyle = '#ffdbac';
    ctx.lineWidth = 3;
    const armWave = Math.sin(animationFrame * 0.2) * 5;
    ctx.beginPath();
    ctx.moveTo(centerX - width/6, centerY - height/8);
    ctx.lineTo(centerX - width/3, centerY + armWave);
    ctx.moveTo(centerX + width/6, centerY - height/8);
    ctx.lineTo(centerX + width/3, centerY - armWave);
    ctx.stroke();
    
    // ë‹¤ë¦¬
    const legMove = Math.sin(animationFrame * 0.25) * 3;
    ctx.beginPath();
    ctx.moveTo(centerX - width/12, centerY + height/4);
    ctx.lineTo(centerX - width/8, centerY + height/2 + legMove);
    ctx.moveTo(centerX + width/12, centerY + height/4);
    ctx.lineTo(centerX + width/8, centerY + height/2 - legMove);
    ctx.stroke();
    
    // ì–¼êµ´ í‘œì •
    ctx.fillStyle = '#333';
    ctx.beginPath();
    ctx.arc(centerX - 2, centerY - height/3 - 1, 1, 0, Math.PI * 2);
    ctx.arc(centerX + 2, centerY - height/3 - 1, 1, 0, Math.PI * 2);
    ctx.fill();
    
    // ì… (ë†€ë€ í‘œì •)
    ctx.beginPath();
    ctx.arc(centerX, centerY - height/3 + 2, 2, 0, Math.PI);
    ctx.stroke();
    
    ctx.restore();
}

// íŒŒì›Œì ¤ ê·¸ë¦¬ê¸° (ì—ë„ˆì§€ ìŒë£Œ ëª¨ì–‘)
function drawPowerGel(x, y, width, height) {
    ctx.save();
    
    // ë³‘ ëª¨ì–‘
    ctx.fillStyle = '#ffd93d';
    ctx.fillRect(x + 2, y + 4, width - 4, height - 8);
    
    // ìº¡
    ctx.fillStyle = '#ff6b6b';
    ctx.fillRect(x + 4, y, width - 8, 6);
    
    // ë°˜ì§ì´ëŠ” íš¨ê³¼
    ctx.fillStyle = '#fff';
    ctx.fillRect(x + 4, y + 6, 2, height - 10);
    
    // ë¼ë²¨
    ctx.fillStyle = '#333';
    ctx.font = '8px Arial';
    ctx.fillText('E', x + width/2 - 3, y + height/2 + 2);
    
    ctx.restore();
}

// ìˆ˜í†µ ê·¸ë¦¬ê¸° (ë¬¼ ì•„ì´í…œ)
function drawWaterBottle(x, y, width, height) {
    ctx.save();
    
    // ìˆ˜í†µ ë³¸ì²´ (íŒŒë€ìƒ‰)
    ctx.fillStyle = '#4dabf7';
    ctx.fillRect(x + 1, y + 3, width - 2, height - 6);
    
    // ìˆ˜í†µ ëšœê»‘
    ctx.fillStyle = '#228be6';
    ctx.fillRect(x + 3, y, width - 6, 4);
    
    // ë¬¼ê²° ë¬´ëŠ¬ (ë¬¼ í‘œí˜„)
    ctx.strokeStyle = '#74c0fc';
    ctx.lineWidth = 1;
    for(let i = 0; i < 3; i++) {
        ctx.beginPath();
        const waveY = y + 8 + i * 3;
        const waveOffset = Math.sin((animationFrame * 0.1) + i) * 2;
        ctx.moveTo(x + 3, waveY + waveOffset);
        ctx.quadraticCurveTo(x + width/2, waveY - 1 + waveOffset, x + width - 3, waveY + waveOffset);
        ctx.stroke();
    }
    
    // ë°˜ì§ì´ëŠ” íš¨ê³¼
    ctx.fillStyle = '#fff';
    ctx.fillRect(x + 2, y + 4, 2, height - 8);
    
    // ë¼ë²¨
    ctx.fillStyle = '#333';
    ctx.font = '8px Arial';
    ctx.fillText('H2O', x + width/2 - 6, y + height/2 + 2);
    
    ctx.restore();
}

// ë°°ê²½ ë„ë¡œ ê·¸ë¦¬ê¸°
function drawRoad() {
    // 1. ë„ë¡œ ë°”ë‹¥ (íšŒìƒ‰ ì•„ìŠ¤íŒ”íŠ¸) - ì „ì²´ ìº”ë²„ìŠ¤ë¥¼ íšŒìƒ‰ìœ¼ë¡œ ì¹ í•¨
    ctx.fillStyle = '#2d3748';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // 2. ìì „ê±° ì „ìš© ë„ë¡œ (ë¶‰ì€ìƒ‰) - ê°€ìš´ë° ë¶€ë¶„ë§Œ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ ì¹ í•¨
    ctx.fillStyle = '#c53030';
    ctx.fillRect(60, 0, canvas.width - 120, canvas.height);
    
    // 3. ìì „ê±° ì „ìš© ë„ë¡œ í…Œë‘ë¦¬ (í°ìƒ‰ ì‹¤ì„ )
    ctx.strokeStyle = '#ffffff';
    ctx.lineWidth = 3;
    ctx.beginPath();
    ctx.moveTo(60, 0);                    // ì™¼ìª½ ê²½ê³„ì„  ì‹œì‘
    ctx.lineTo(60, canvas.height);        // ì™¼ìª½ ê²½ê³„ì„  ë
    ctx.moveTo(canvas.width - 60, 0);     // ì˜¤ë¥¸ìª½ ê²½ê³„ì„  ì‹œì‘
    ctx.lineTo(canvas.width - 60, canvas.height); // ì˜¤ë¥¸ìª½ ê²½ê³„ì„  ë
    ctx.stroke();
    
    // 4. ë„ë¡œ ì„  ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•œ ì˜¤í”„ì…‹ ê³„ì‚°
    const roadOffset = powerBoostTime > 0 ? (animationFrame * 3) % 20 : (animationFrame * 0.5) % 20;
    
    // 5. ì¤‘ì•™ì„  (ë…¸ë€ìƒ‰ ì ì„ ) - ìì „ê±° ë„ë¡œ ì¤‘ì•™
    ctx.strokeStyle = powerBoostTime > 0 ? '#ffd93d' : '#f6e05e';
    ctx.lineWidth = 2;
    ctx.setLineDash([10, 10]);            // ì ì„  íŒ¨í„´: 10px ì„ , 10px ê³µë°±
    ctx.lineDashOffset = -roadOffset;     // ì ì„ ì´ ìœ„ë¡œ ì›€ì§ì´ëŠ” íš¨ê³¼
    
    ctx.beginPath();
    ctx.moveTo(canvas.width / 2, 0);
    ctx.lineTo(canvas.width / 2, canvas.height);
    ctx.stroke();
    
    // 6. ìì „ê±° ë„ë¡œ ì–‘ìª½ ë‚´ë¶€ ì•ˆë‚´ì„  (í°ìƒ‰ ì ì„ )
    ctx.strokeStyle = '#ffffff';
    ctx.lineWidth = 1;
    ctx.setLineDash([5, 5]);              // ë” ì§§ì€ ì ì„ 
    
    // ì¢Œì¸¡ ë‚´ë¶€ì„  (ê²½ê³„ì„ ì—ì„œ 20px ì•ˆìª½)
    ctx.beginPath();
    ctx.moveTo(80, 0);
    ctx.lineTo(80, canvas.height);
    ctx.stroke();
    
    // ìš°ì¸¡ ë‚´ë¶€ì„ 
    ctx.beginPath();
    ctx.moveTo(canvas.width - 80, 0);
    ctx.lineTo(canvas.width - 80, canvas.height);
    ctx.stroke();
    
    ctx.setLineDash([]);                  // ì ì„  ì„¤ì • ì´ˆê¸°í™”
    
    // 7. ìì „ê±° ë§ˆí¬ ì•„ì´ì½˜ë“¤ (ë„ë¡œ ìœ„ì— ì£¼ê¸°ì ìœ¼ë¡œ í‘œì‹œ)
    ctx.fillStyle = '#ffffff';
    ctx.globalAlpha = 0.3;                // ë°˜íˆ¬ëª…í•˜ê²Œ
    for(let i = 0; i < 5; i++) {
        // y ìœ„ì¹˜ ê³„ì‚°: ìœ„ë¡œ ì´ë™í•˜ë©´ì„œ ë°˜ë³µ
        const y = (animationFrame * 2 + i * 150) % (canvas.height + 150) - 50;
        if(y > -50 && y < canvas.height) { // í™”ë©´ì— ë³´ì´ëŠ” ê²½ìš°ë§Œ
            drawBikeIcon(canvas.width / 2 - 15, y);
        }
    }
    ctx.globalAlpha = 1;                  // íˆ¬ëª…ë„ ì›ë³µ
}

function drawBikeIcon(x, y) {
    ctx.save();                           // í˜„ì¬ ìŠ¤íƒ€ì¼ ì €ì¥
    ctx.strokeStyle = '#ffffff';          // í°ìƒ‰ìœ¼ë¡œ ê·¸ë¦¬ê¸°
    ctx.lineWidth = 2;
    
    // 1. ìì „ê±° ë°”í€´ ë‘ ê°œ ê·¸ë¦¬ê¸°
    ctx.beginPath();
    ctx.arc(x + 5, y + 10, 4, 0, Math.PI * 2);  // ì™¼ìª½ ë°”í€´ (ì›)
    ctx.arc(x + 20, y + 10, 4, 0, Math.PI * 2); // ì˜¤ë¥¸ìª½ ë°”í€´ (ì›)
    ctx.stroke();
    
    // 2. ìì „ê±° í”„ë ˆì„ ê·¸ë¦¬ê¸°
    ctx.beginPath();
    ctx.moveTo(x + 5, y + 10);            // ì™¼ìª½ ë°”í€´ ì¤‘ì‹¬ì—ì„œ ì‹œì‘
    ctx.lineTo(x + 12.5, y);              // ìƒë‹¨ ì¤‘ì•™ìœ¼ë¡œ
    ctx.lineTo(x + 20, y + 10);           // ì˜¤ë¥¸ìª½ ë°”í€´ ì¤‘ì‹¬ìœ¼ë¡œ
    ctx.moveTo(x + 12.5, y);              // ìƒë‹¨ ì¤‘ì•™ì—ì„œ ì‹œì‘
    ctx.lineTo(x + 12.5, y + 5);          // ì‹œíŠ¸ í¬ìŠ¤íŠ¸
    ctx.stroke();
    
    ctx.restore();                        // ì›ë˜ ìŠ¤íƒ€ì¼ ë³µì›
}

function spawnObstacle() {
    let width = 40;
    let x = Math.random() * (canvas.width - width - 100) + 50;
    obstacles.push({x, y: -80, width, height: 60});
}

function spawnPowerGel() {
    let size = 20;
    let x = Math.random() * (canvas.width - size - 100) + 50;
    powerGels.push({x, y: -20, width: size, height: size});
}

function spawnWaterBottle() {
    let size = 18;
    let x = Math.random() * (canvas.width - size - 100) + 50;
    waterBottles.push({x, y: -18, width: size, height: size});
}

let gameOver = false; // ì „ì—­ ë³€ìˆ˜

function update() {
    animationFrame++;
    
    // íŒŒì›Œ ë¶€ìŠ¤íŠ¸ ì‹œê°„ ê°ì†Œ
    if(powerBoostTime > 0) {
        powerBoostTime--;
    }
    
    // ë³´í˜¸ë§‰ ì‹œê°„ ê°ì†Œ
    if(shieldTime > 0) {
        shieldTime--;
    }
    
    // ì´ë™ (ë„ë¡œ ê²½ê³„ ë‚´ì—ì„œë§Œ)
    const moveSpeed = powerBoostTime > 0 ? 8 : 5;
    if(keys['ArrowLeft'] && bike.x > 60) bike.x -= moveSpeed;
    if(keys['ArrowRight'] && bike.x + bike.width < canvas.width - 60) bike.x += moveSpeed;

    // íŒŒì›Œ ë¶€ìŠ¤íŠ¸ ì‹œ ë” ë¹ ë¥¸ ê²Œì„ ì†ë„
    const currentGameSpeed = powerBoostTime > 0 ? gameSpeed * 2.5 : gameSpeed;

    // ì¥ì• ë¬¼ ì´ë™ (íŒŒì›Œ ë¶€ìŠ¤íŠ¸ ì‹œ ë” ë¹ ë¥´ê²Œ)
    obstacles.forEach(obs => obs.y += currentGameSpeed);
    obstacles = obstacles.filter(obs => obs.y < canvas.height);

    // íŒŒì›Œì ¤ ì´ë™
    powerGels.forEach(p => p.y += currentGameSpeed);
    powerGels = powerGels.filter(p => p.y < canvas.height);
    
    // ìˆ˜í†µ ì´ë™
    waterBottles.forEach(w => w.y += currentGameSpeed);
    waterBottles = waterBottles.filter(w => w.y < canvas.height);

    // ì¶©ëŒ ì²´í¬ (ë³´í˜¸ë§‰ì´ ìˆìœ¼ë©´ ë¬´ì‹œ)
    if(!gameOver && shieldTime <= 0) {
        obstacles.forEach(obs => {
            if(bike.x < obs.x + obs.width - 10 && bike.x + bike.width - 10 > obs.x &&
               bike.y < obs.y + obs.height - 10 && bike.y + bike.height - 10 > obs.y) {
			   gameOver = true; // í•œ ë²ˆë§Œ ì‹¤í–‰
                alert("ê²Œì„ ì¢…ë£Œ! ì ìˆ˜: " + Math.floor(score));
                document.location.reload();
				
            }
        });
    }

    // íŒŒì›Œì ¤ íšë“
    powerGels.forEach((p, index) => {
        if(bike.x < p.x + p.width && bike.x + bike.width > p.x &&
           bike.y < p.y + p.height && bike.y + bike.height > p.y) {
            
            const points = 10;
            score += points;
            powerBoostTime = 180; // 3ì´ˆê°„ íŒŒì›Œ ë¶€ìŠ¤íŠ¸
            
            // ë…¸ë€ìƒ‰ íŒŒí‹°í´ íš¨ê³¼
            createParticles(p.x + p.width/2, p.y + p.height/2, 12);
            createScorePopup(p.x, p.y - 10, points);
            
            powerGels.splice(index, 1);
        }
    });
    
    // ìˆ˜í†µ íšë“
    waterBottles.forEach((w, index) => {
        if(bike.x < w.x + w.width && bike.x + bike.width > w.x &&
           bike.y < w.y + w.height && bike.y + bike.height > w.y) {
            
            const points = 5;
            score += points;
            shieldTime = 300; // 5ì´ˆê°„ ë³´í˜¸ë§‰
            
            // íŒŒë€ìƒ‰ íŒŒí‹°í´ íš¨ê³¼
            for(let i = 0; i < 10; i++) {
                particles.push({
                    x: w.x + w.width/2,
                    y: w.y + w.height/2,
                    vx: (Math.random() - 0.5) * 8,
                    vy: (Math.random() - 0.5) * 8,
                    size: Math.random() * 6 + 2,
                    color: `hsl(${200 + Math.random() * 40}, 100%, 60%)`,
                    life: 1,
                    decay: Math.random() * 0.02 + 0.01
                });
            }
            createScorePopup(w.x, w.y - 10, points);
            
            waterBottles.splice(index, 1);
        }
    });

    // ì ìˆ˜ ì¦ê°€ ë° ê²Œì„ ì†ë„ ì¦ê°€
    score += 0.02;
    if(Math.floor(score) % 50 === 0) {
        gameSpeed = Math.min(gameSpeed + 0.001, 4);
    }
}

function draw() {
    // ë°°ê²½ ê·¸ë¼ë””ì–¸íŠ¸ (íŒŒì›Œ ë¶€ìŠ¤íŠ¸ ì‹œ ë” ì—­ë™ì )
    const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
	if(powerBoostTime > 0) {
		gradient.addColorStop(0, '#4a5568');
		gradient.addColorStop(0.5, '#ffd93d');
		gradient.addColorStop(1, '#ff6b6b');
	} else {
		gradient.addColorStop(0, '#718096');
		gradient.addColorStop(0.5, '#a0aec0');
		gradient.addColorStop(1, '#e2e8f0');
	}
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // íŒŒì›Œ ë¶€ìŠ¤íŠ¸ ì‹œ ë°°ê²½ì— ìŠ¤í”¼ë“œ ë¼ì¸ íš¨ê³¼
    if(powerBoostTime > 0) {
        ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
        ctx.lineWidth = 2;
        for(let i = 0; i < 10; i++) {
            const x = Math.random() * canvas.width;
            const speed = 8 + Math.random() * 12;
            const y = (animationFrame * speed + i * 60) % (canvas.height + 100);
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x - 20, y - 40);
            ctx.stroke();
        }
    }
    
    // ë„ë¡œ ê·¸ë¦¬ê¸°
    drawRoad();

    // ìì „ê±° íƒ€ëŠ” ì‚¬ëŒ
    drawBiker(bike.x, bike.y, bike.width, bike.height);

    // ì‚¬ëŒ ì¥ì• ë¬¼ë“¤
    obstacles.forEach(obs => drawPerson(obs.x, obs.y, obs.width, obs.height));

    // íŒŒì›Œì ¤
    powerGels.forEach(p => drawPowerGel(p.x, p.y, p.width, p.height));
    
    // ìˆ˜í†µ
    waterBottles.forEach(w => drawWaterBottle(w.x, w.y, w.width, w.height));

    // íŒŒí‹°í´ íš¨ê³¼
    updateAndDrawParticles();
    
    // ì ìˆ˜ íŒì—…
    updateAndDrawScorePopups();

    // ì ìˆ˜ ë° ì†ë„ í‘œì‹œ
    ctx.fillStyle = '#fff';
    ctx.font = 'bold 20px Arial';
    ctx.strokeStyle = '#000';
    ctx.lineWidth = 1;
    ctx.strokeText('ì ìˆ˜: ' + Math.floor(score), 10, 30);
    ctx.fillText('ì ìˆ˜: ' + Math.floor(score), 10, 30);
    
    ctx.font = '14px Arial';
    const displaySpeed = powerBoostTime > 0 ? (gameSpeed * 2.5).toFixed(1) : gameSpeed.toFixed(1);
    ctx.strokeText('ì†ë„: ' + displaySpeed, 10, 55);
    ctx.fillText('ì†ë„: ' + displaySpeed, 10, 55);
    
    // íŒŒì›Œ ë¶€ìŠ¤íŠ¸ ìƒíƒœ í‘œì‹œ
    if(powerBoostTime > 0) {
        // ê¹œë¹¡ì´ëŠ” íš¨ê³¼
        const flashAlpha = Math.sin(animationFrame * 0.3) * 0.3 + 0.7;
        ctx.globalAlpha = flashAlpha;
        
        ctx.fillStyle = '#ffd93d';
        ctx.strokeStyle = '#ff6b6b';
        ctx.font = 'bold 18px Arial';
        ctx.strokeText('âš¡ SPEED BOOST! âš¡', 10, 80);
        ctx.fillText('âš¡ SPEED BOOST! âš¡', 10, 80);
        
        ctx.globalAlpha = 1;
        
        // íŒŒì›Œ ë¶€ìŠ¤íŠ¸ ê²Œì´ì§€
        const gaugeWidth = 120;
        const gaugeHeight = 10;
        const gaugeX = 10;
        const gaugeY = 85;
        
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 2;
        ctx.strokeRect(gaugeX, gaugeY, gaugeWidth, gaugeHeight);
        
        // ê²Œì´ì§€ ë°°ê²½
        ctx.fillStyle = '#333';
        ctx.fillRect(gaugeX, gaugeY, gaugeWidth, gaugeHeight);
        
        // ê²Œì´ì§€ ì±„ìš°ê¸° (ê·¸ë¼ë””ì–¸íŠ¸)
        const gaugeGradient = ctx.createLinearGradient(gaugeX, gaugeY, gaugeX + gaugeWidth, gaugeY);
        gaugeGradient.addColorStop(0, '#ff6b6b');
        gaugeGradient.addColorStop(0.5, '#ffd93d');
        gaugeGradient.addColorStop(1, '#4ecdc4');
        
        ctx.fillStyle = gaugeGradient;
        const fillWidth = (powerBoostTime / 180) * gaugeWidth;
        ctx.fillRect(gaugeX, gaugeY, fillWidth, gaugeHeight);
    }
    
    // ë³´í˜¸ë§‰ ìƒíƒœ í‘œì‹œ
    if(shieldTime > 0) {
        // ë³´í˜¸ë§‰ íš¨ê³¼ë¥¼ ìì „ê±° ì£¼ë³€ì— ê·¸ë¦¬ê¸°
        ctx.save();
        ctx.globalAlpha = 0.3 + Math.sin(animationFrame * 0.2) * 0.2;
        ctx.strokeStyle = '#4dabf7';
        ctx.lineWidth = 3;
        ctx.shadowColor = '#4dabf7';
        ctx.shadowBlur = 10;
        ctx.beginPath();
        ctx.arc(bike.x + bike.width/2, bike.y + bike.height/2, 35, 0, Math.PI * 2);
        ctx.stroke();
        ctx.restore();
        
        // ë³´í˜¸ë§‰ í…ìŠ¤íŠ¸ í‘œì‹œ
        const shieldFlashAlpha = Math.sin(animationFrame * 0.2) * 0.3 + 0.7;
        ctx.globalAlpha = shieldFlashAlpha;
        
        ctx.fillStyle = '#4dabf7';
        ctx.strokeStyle = '#228be6';
        ctx.font = 'bold 16px Arial';
        const shieldY = powerBoostTime > 0 ? 120 : 80;
        ctx.strokeText('ğŸ›¡ï¸ SHIELD ACTIVE! ğŸ›¡ï¸', 10, shieldY);
        ctx.fillText('ğŸ›¡ï¸ SHIELD ACTIVE! ğŸ›¡ï¸', 10, shieldY);
        
        ctx.globalAlpha = 1;
        
        // ë³´í˜¸ë§‰ ê²Œì´ì§€
        const shieldGaugeWidth = 120;
        const shieldGaugeHeight = 8;
        const shieldGaugeX = 10;
        const shieldGaugeY = shieldY + 5;
        
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 1;
        ctx.strokeRect(shieldGaugeX, shieldGaugeY, shieldGaugeWidth, shieldGaugeHeight);
        
        // ê²Œì´ì§€ ë°°ê²½
        ctx.fillStyle = '#333';
        ctx.fillRect(shieldGaugeX, shieldGaugeY, shieldGaugeWidth, shieldGaugeHeight);
        
        // ë³´í˜¸ë§‰ ê²Œì´ì§€ ì±„ìš°ê¸°
        ctx.fillStyle = '#4dabf7';
        const shieldFillWidth = (shieldTime / 300) * shieldGaugeWidth;
        ctx.fillRect(shieldGaugeX, shieldGaugeY, shieldFillWidth, shieldGaugeHeight);
    }
    
    // ì¡°ì‘ë²• í‘œì‹œ
    ctx.font = '12px Arial';
    ctx.fillStyle = 'rgba(255,255,255,0.7)';
    ctx.fillText('â† â†’ í‚¤ë¡œ ì´ë™', 10, canvas.height - 10);
}

function gameLoop() {
    update();
    draw();
    requestAnimationFrame(gameLoop);
}

// ì£¼ê¸°ì ìœ¼ë¡œ ì¥ì• ë¬¼ê³¼ íŒŒì›Œì ¤, ìˆ˜í†µ ìƒì„±
setInterval(spawnObstacle, 1500);
// íŒŒì›Œì ¤ ìƒì„± ê°„ê²©ì„ 4ì´ˆì—ì„œ 2.5ì´ˆë¡œ ì¤„ì—¬ì„œ ë” ìì£¼ ë‚˜ì˜¤ê²Œ ìˆ˜ì •
setInterval(spawnPowerGel, 2500);
// ìˆ˜í†µì€ 3.5ì´ˆë§ˆë‹¤ ìƒì„±
setInterval(spawnWaterBottle, 3500);

// ê²Œì„ ì‹œì‘
gameLoop();
</script>
</body>
</html>